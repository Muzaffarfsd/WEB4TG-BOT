"""Multimodal Vision Sales Analyzer ‚Äî World-Class Image Analysis for Sales.

Analyzes client-sent images (screenshots, photos, designs, documents) and generates
sales-oriented responses with specific recommendations, pricing, and next steps.

Architecture:
1. Image Classification ‚Äî determines what type of image the client sent
2. Sales-Oriented Analysis Prompt ‚Äî tailored per image type
3. Structured Recommendations ‚Äî with specific WEB4TG services and pricing
4. Smart Button Generation ‚Äî context-aware CTAs after analysis
5. Lead Scoring Boost ‚Äî high-intent signal from image uploads
6. Manager Notification ‚Äî for hot leads sending images
"""

import logging
from typing import Dict, Optional, Tuple, List
from enum import Enum

logger = logging.getLogger(__name__)


class ImageType(Enum):
    APP_SCREENSHOT = "app_screenshot"
    WEBSITE_SCREENSHOT = "website_screenshot"
    COMPETITOR_APP = "competitor_app"
    DESIGN_MOCKUP = "design_mockup"
    BUSINESS_PHOTO = "business_photo"
    DOCUMENT_TZ = "document_tz"
    PRODUCT_PHOTO = "product_photo"
    MENU_CATALOG = "menu_catalog"
    ANALYTICS_SCREENSHOT = "analytics_screenshot"
    GENERAL = "general"


IMAGE_TYPE_PROMPTS: Dict[str, str] = {
    ImageType.APP_SCREENSHOT.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è/–º–∏–Ω–∏-–∞–ø–ø–∞. –≠—Ç–æ –°–ò–õ–¨–ù–ï–ô–®–ò–ô —Å–∏–≥–Ω–∞–ª –∏–Ω—Ç–µ—Ä–µ—Å–∞.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **UX-–∞—É–¥–∏—Ç** (3-5 –ø—É–Ω–∫—Ç–æ–≤): –Ω–∞–π–¥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —é–∑–∞–±–∏–ª–∏—Ç–∏
   - –ù–∞–≤–∏–≥–∞—Ü–∏—è: –µ—Å—Ç—å –ª–∏ –≤–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞? –°–∫–æ–ª—å–∫–æ —Ç–∞–ø–æ–≤ –¥–æ –∫–ª—é—á–µ–≤–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è?
   - –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è: —á—Ç–æ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –ø–µ—Ä–≤—ã–º? –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —ç—Ç–æ?
   - CTA-–∫–Ω–æ–ø–∫–∏: –≤–∏–¥–Ω—ã –ª–∏? –ü–æ–Ω—è—Ç–µ–Ω –ª–∏ —Ç–µ–∫—Å—Ç? –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã?
   - –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è: —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–æ–≤, –æ—Ç—Å—Ç—É–ø—ã, –∑–æ–Ω—ã —Ç–∞–ø–æ–≤
   - –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è: –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ–Ω—è—Ç—å —á—Ç–æ –¥–µ–ª–∞—Ç—å?

2. **–ë–∏–∑–Ω–µ—Å-—É–ø—É—â–µ–Ω–∏—è**: —á—Ç–æ —Ç–µ—Ä—è–µ—Ç –∫–ª–∏–µ–Ω—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
   - –ù–µ—Ç –∫–æ—Ä–∑–∏–Ω—ã/–∫–∞—Ç–∞–ª–æ–≥–∞ ‚Üí –ø–æ—Ç–µ—Ä—è –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
   - –ù–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ ‚Üí –ø–æ—Ç–µ—Ä—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫
   - –ù–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π ‚Üí –ø–æ—Ç–µ—Ä—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç–∏
   - –ù–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ ‚Üí —Å–ª–µ–ø–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

3. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ WEB4TG Studio**:
   - –ù–∞–∑–æ–≤–∏ 3-5 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π —Å –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∞
   - –ü—Ä–∏–≤—è–∂–∏ –∫ –ø–∞–∫–µ—Ç–∞–º: —á—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ –°—Ç–∞—Ä—Ç–µ—Ä–µ (150 000‚ÇΩ), –ë–∏–∑–Ω–µ—Å–µ (250 000‚ÇΩ), –ü—Ä–µ–º–∏—É–º–µ (400 000‚ÇΩ)
   - –ü—Ä–µ–¥–ª–æ–∂–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç –∫–∞–∫ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥""",

    ImageType.WEBSITE_SCREENSHOT.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç —Å–≤–æ–µ–≥–æ —Å–∞–π—Ç–∞. –û–Ω —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å –≤ Telegram Mini App.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–û—Ü–µ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–∞–π—Ç–∞** (–ø–æ 10-–±–∞–ª—å–Ω–æ–π —à–∫–∞–ª–µ):
   - –î–∏–∑–∞–π–Ω –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å
   - –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
   - –Æ–∑–∞–±–∏–ª–∏—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
   - –ö–æ–Ω–≤–µ—Ä—Å–∏–æ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

2. **–ü–æ—á–µ–º—É Telegram Mini App –ª—É—á—à–µ –¥–ª—è –µ–≥–æ –±–∏–∑–Ω–µ—Å–∞**:
   - –í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ vs –≤—Ä–µ–º—è –≤ Telegram (–≤ 3-5x –±–æ–ª—å—à–µ)
   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ 1 –∫–ª–∏–∫ vs —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–∫–æ–Ω–≤–µ—Ä—Å–∏—è +40%)
   - Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è vs email (–æ—Ç–∫—Ä—ã—Ç–∏–µ 85% vs 20%)
   - –ù–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ vs –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∞–π—Ç

3. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏**:
   - –ö–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–∞–π—Ç–∞ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ Mini App
   - –ß—Ç–æ —É–ª—É—á—à–∏—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ
   - –¢–∞–π–º–ª–∞–π–Ω –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å
   - –ß—Ç–æ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∏—Ç —Å–≤–µ—Ä—Ö —Ç–µ–∫—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞""",

    ImageType.COMPETITOR_APP.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞. –≠—Ç–æ —Å–∏–≥–Ω–∞–ª –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä—ã–Ω–∫–∞.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞** (–æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ):
   - –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ
   - –°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: —á—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
   - UX-–ø–∞—Ç—Ç–µ—Ä–Ω—ã: —á—Ç–æ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ–Ω—è—Ç—å, —á—Ç–æ ‚Äî –Ω–µ—Ç

2. **–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –õ–£–ß–®–ï —Å WEB4TG Studio**:
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞—à–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
   - –ö–∞–∫–∏–µ —Ñ–∏—á–∏ –¥–æ–±–∞–≤–∏—Ç—å, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
   - –ö–∞–∫ –≤—ã–∏–≥—Ä–∞—Ç—å –≤ UX/—Å–∫–æ—Ä–æ—Å—Ç–∏/–∫–æ–Ω–≤–µ—Ä—Å–∏–∏

3. **–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏—è**: 3 –∫–ª—é—á–µ–≤—ã—Ö –æ—Ç–ª–∏—á–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –¥–∞–¥—É—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç—É

–í–ê–ñ–ù–û: –ù–µ –∫—Ä–∏—Ç–∏–∫—É–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ. –ë—É–¥—å –æ–±—ä–µ–∫—Ç–∏–≤–µ–Ω, –ø–æ–∫–∞–∂–∏ —É–≤–∞–∂–µ–Ω–∏–µ –∫ —Ä–∞–±–æ—Ç–µ, –Ω–æ –ø–æ–¥—á–µ—Ä–∫–Ω–∏, –∫–∞–∫ WEB4TG –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –µ—â—ë –ª—É—á—à–µ.""",

    ImageType.DESIGN_MOCKUP.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –¥–∏–∑–∞–π–Ω-–º–∞–∫–µ—Ç –∏–ª–∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø. –≠—Ç–æ –û–ß–ï–ù–¨ –≥–æ—Ä—è—á–∏–π –ª–∏–¥ ‚Äî –æ–Ω —É–∂–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ—Ç.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–û—Ü–µ–Ω–∫–∞ –º–∞–∫–µ—Ç–∞** (–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –í–∏–∑—É–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å: —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π? –¢—Ä–µ–Ω–¥—ã 2025-2026?
   - –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞: —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –∏–µ—Ä–∞—Ä—Ö–∏—è
   - –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞: –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ—Å—Ç—å, –∫–æ–Ω—Ç—Ä–∞—Å—Ç—ã
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Telegram Mini Apps guidelines

2. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
   - –ß—Ç–æ –æ—Ç–ª–∏—á–Ω–æ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–º–µ—Ç—å (–≤–∞–∂–Ω–æ –¥–ª—è –¥–æ–≤–µ—Ä–∏—è)
   - –ß—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ, —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
   - –ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å ‚Äî UX-–ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–≤—ã—Å—è—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é

3. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**:
   - '–≠—Ç–æ—Ç –º–∞–∫–µ—Ç –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞ X –¥–Ω–µ–π'
   - –†–µ–∫–æ–º–µ–Ω–¥—É–π –ø–∞–∫–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
   - –ü—Ä–µ–¥–ª–æ–∂–∏ –±—Ä–∏—Ñ –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π""",

    ImageType.BUSINESS_PHOTO.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Ñ–æ—Ç–æ —Å–≤–æ–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞ (–º–∞–≥–∞–∑–∏–Ω, —Ä–µ—Å—Ç–æ—Ä–∞–Ω, —Å–∞–ª–æ–Ω, –æ—Ñ–∏—Å).

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø –±–∏–∑–Ω–µ—Å–∞** –ø–æ —Ñ–æ—Ç–æ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–µ—à–µ–Ω–∏–µ:
   - –†–µ—Å—Ç–æ—Ä–∞–Ω/–∫–∞—Ñ–µ ‚Üí Mini App —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π, –º–µ–Ω—é, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º
   - –ú–∞–≥–∞–∑–∏–Ω ‚Üí Mini App —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º, –∫–æ—Ä–∑–∏–Ω–æ–π, –æ–ø–ª–∞—Ç–æ–π
   - –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã ‚Üí Mini App —Å –∑–∞–ø–∏—Å—å—é, —É—Å–ª—É–≥–∞–º–∏, –ª–æ—è–ª—å–Ω–æ—Å—Ç—å—é
   - –§–∏—Ç–Ω–µ—Å ‚Üí Mini App —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º, –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞–º–∏, —Ç—Ä–µ–∫–µ—Ä–æ–º

2. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**:
   - '–î–ª—è –≤–∞—à–µ–≥–æ [—Ç–∏–ø –±–∏–∑–Ω–µ—Å–∞] –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥–æ–π–¥—ë—Ç...'
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥ —ç—Ç–æ—Ç –±–∏–∑–Ω–µ—Å
   - –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –∏–∑ –ø–æ—Ö–æ–∂–µ–π –Ω–∏—à–∏ (—á–µ—Ä–µ–∑ search_knowledge_base)

3. **ROI-–ø—Ä–æ–≥–Ω–æ–∑**: –∫–∞–∫ Mini App —É–≤–µ–ª–∏—á–∏—Ç –≤—ã—Ä—É—á–∫—É —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞""",

    ImageType.PRODUCT_PHOTO.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞/–ø—Ä–æ–¥—É–∫—Ü–∏–∏. –û–Ω —Ö–æ—á–µ—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ Telegram.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–û—Ü–µ–Ω–∫–∞ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –æ–Ω–ª–∞–π–Ω-–ø—Ä–æ–¥–∞–∂**:
   - –ö–∞–∫ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥–µ Mini App
   - –ù—É–∂–Ω—ã –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ (360¬∞, zoom, –≤–∏–¥–µ–æ)
   - –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ —Ç–æ–≤–∞—Ä–∞

2. **–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∂**:
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ –¥–ª—è —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
   - –°—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–∫—É–ø–∫–∏ (–∫–∞—Ç–∞–ª–æ–≥ ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ ‚Üí –∫–æ—Ä–∑–∏–Ω–∞ ‚Üí –æ–ø–ª–∞—Ç–∞)
   - –î–æ–ø—Ä–æ–¥–∞–∂–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π

3. **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**: '–ú–∞–≥–∞–∑–∏–Ω —Å –≤–∞—à–∏–º —Ç–æ–≤–∞—Ä–æ–º ‚Äî –æ—Ç 150 000‚ÇΩ, –∑–∞–ø—É—Å–∫ –∑–∞ 7-10 –¥–Ω–µ–π'""",

    ImageType.MENU_CATALOG.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Ñ–æ—Ç–æ –º–µ–Ω—é, –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞ –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥–∞. –•–æ—á–µ—Ç –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ —Ü–∏—Ñ—Ä—É.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞**:
   - –ß—Ç–æ —Ç–µ—Ä—è–µ—Ç—Å—è –≤ –±—É–º–∞–∂–Ω–æ–º/PDF —Ñ–æ—Ä–º–∞—Ç–µ
   - –ü–æ—á–µ–º—É –∫–ª–∏–µ–Ω—Ç—ã –Ω–µ –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç –±–æ–ª—å—à–µ (–Ω–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø–æ–∏—Å–∫–∞, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π)
   - –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

2. **–¶–∏—Ñ—Ä–æ–≤–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ Mini App**:
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é/–∫–∞—Ç–∞–ª–æ–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–æ–∏—Å–∫–æ–º
   - –§–æ—Ç–æ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞/–±–ª—é–¥–∞
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ '–° —ç—Ç–∏–º –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç'
   - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è: '–í–∞—à–∏ –ª—é–±–∏–º—ã–µ –±–ª—é–¥–∞'
   - –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: –±–æ–Ω—É—Å—ã –∑–∞ –∑–∞–∫–∞–∑—ã

3. **–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç**: —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –Ω–∞ 25-35% –∑–∞ —Å—á—ë—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏ —É–¥–æ–±—Å—Ç–≤–∞""",

    ImageType.ANALYTICS_SCREENSHOT.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏/–º–µ—Ç—Ä–∏–∫. –û–Ω –¥—É–º–∞–µ—Ç –æ —Ä–æ—Å—Ç–µ –±–∏–∑–Ω–µ—Å–∞.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** (–µ—Å–ª–∏ –≤–∏–¥–Ω–æ):
   - –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
   - –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

2. **–ö–∞–∫ Mini App —É–ª—É—á—à–∏—Ç –µ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫—É**:
   - –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –î–∞—à–±–æ—Ä–¥ —Å –∫–ª—é—á–µ–≤—ã–º–∏ KPI
   - –ö–æ–≥–æ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ LTV
   - A/B —Ç–µ—Å—Ç—ã –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

3. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ**: –ø–∞–∫–µ—Ç –ë–∏–∑–Ω–µ—Å –∏–ª–∏ –ü—Ä–µ–º–∏—É–º —Å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –º–æ–¥—É–ª–µ–º""",

    ImageType.DOCUMENT_TZ.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç/–¢–ó/–±—Ä–∏—Ñ. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≥–æ—Ä—è—á–∏–π –ª–∏–¥ ‚Äî –æ–Ω —É–∂–µ –≥–æ—Ç–æ–≤.

–ó–ê–î–ê–ß–ê –ê–ù–ê–õ–ò–ó–ê:
1. **–†–∞–∑–±–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞**:
   - –ß—Ç–æ –∫–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç (–µ—Å–ª–∏ —á–∏—Ç–∞–µ–º–æ)
   - –ö–∞–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞—à–∏–º –ø–∞–∫–µ—Ç–∞–º

2. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞**:
   - '–û—Ç–ª–∏—á–Ω–æ–µ –¢–ó, –≤–∏–¥–Ω–æ —á—Ç–æ –≤—ã —Å–µ—Ä—å—ë–∑–Ω–æ –ø–æ–¥–æ—à–ª–∏ –∫ –∑–∞–¥–∞—á–µ'
   - –ß—Ç–æ —Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å/—É—Ç–æ—á–Ω–∏—Ç—å
   - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Å—Ä–æ–∫–æ–≤ –∏ –±—é–¥–∂–µ—Ç–∞

3. **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: '–î–∞–≤–∞–π—Ç–µ –æ–±—Å—É–¥–∏–º –¥–µ—Ç–∞–ª–∏ –Ω–∞ —Å–æ–∑–≤–æ–Ω–µ ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —Ç–æ—á–Ω—É—é –æ—Ü–µ–Ω–∫—É –∑–∞ 24 —á–∞—Å–∞'""",

    ImageType.GENERAL.value: """–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —á—Ç–æ –Ω–∞ –Ω—ë–º –∏ —Å–≤—è–∂–∏ —Å —É—Å–ª—É–≥–∞–º–∏ WEB4TG Studio.

–ó–ê–î–ê–ß–ê:
1. –û–ø–∏—à–∏ —á—Ç–æ –≤–∏–¥–∏—à—å –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
2. –ù–∞–π–¥–∏ —Å–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π Telegram Mini Apps
3. –ü—Ä–µ–¥–ª–æ–∂–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ—Ç WEB4TG Studio
4. –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—à—å —Å–≤—è–∑–∞—Ç—å —Å —É—Å–ª—É–≥–∞–º–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ –æ—Ç–≤–µ—Ç—å –ø–æ–ª–µ–∑–Ω–æ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –æ–±—Å—É–¥–∏—Ç—å –ø—Ä–æ–µ–∫—Ç""",
}


VISION_CLASSIFICATION_PROMPT = """–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –û—Ç–≤–µ—Ç—å –û–î–ù–ò–ú —Å–ª–æ–≤–æ–º –∏–∑ —Å–ø–∏—Å–∫–∞:
- app_screenshot (—Å–∫—Ä–∏–Ω—à–æ—Ç –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –º–∏–Ω–∏-–∞–ø–ø–∞)
- website_screenshot (—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–∞–π—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
- competitor_app (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞, —á—É–∂–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- design_mockup (–¥–∏–∑–∞–π–Ω-–º–∞–∫–µ—Ç, –ø—Ä–æ—Ç–æ—Ç–∏–ø, wireframe, Figma)
- business_photo (—Ñ–æ—Ç–æ –±–∏–∑–Ω–µ—Å–∞: –º–∞–≥–∞–∑–∏–Ω, —Ä–µ—Å—Ç–æ—Ä–∞–Ω, —Å–∞–ª–æ–Ω, –æ—Ñ–∏—Å)
- product_photo (—Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞, –ø—Ä–æ–¥—É–∫—Ü–∏–∏)
- menu_catalog (–º–µ–Ω—é, –ø—Ä–∞–π—Å-–ª–∏—Å—Ç, –∫–∞—Ç–∞–ª–æ–≥, –±—É–∫–ª–µ—Ç)
- analytics_screenshot (–≥—Ä–∞—Ñ–∏–∫–∏, –¥–∞—à–±–æ—Ä–¥, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –º–µ—Ç—Ä–∏–∫–∏)
- document_tz (–¥–æ–∫—É–º–µ–Ω—Ç, –¢–ó, –±—Ä–∏—Ñ, —Ç–∞–±–ª–∏—Ü–∞ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏)
- general (–≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ)

–û—Ç–≤–µ—Ç—å –¢–û–õ–¨–ö–û –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ, –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π."""


VISION_SALES_SYSTEM = """–¢—ã ‚Äî –ê–ª–µ–∫—Å, –≤–µ–¥—É—â–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç WEB4TG Studio –∏ —ç–∫—Å–ø–µ—Ä—Ç –ø–æ Telegram Mini Apps.

–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. –≠—Ç–æ –°–ò–õ–¨–ù–´–ô —Å–∏–≥–Ω–∞–ª –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ ‚Äî –æ–Ω –¥–µ–ª–∏—Ç—Å—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–≤–æ—ë–º –±–∏–∑–Ω–µ—Å–µ/–ø—Ä–æ–µ–∫—Ç–µ.

{image_type_prompt}

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û):
- 3-5 –∞–±–∑–∞—Ü–µ–≤, –∫–∞–∂–¥—ã–π —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º—ã—Å–ª—å—é
- –ü–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü: —á—Ç–æ —Ç—ã –í–ò–î–ò–®–¨ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ (–ø–æ–∫–∞–∂–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º)
- –°—Ä–µ–¥–Ω–∏–µ –∞–±–∑–∞—Ü—ã: –∞–Ω–∞–ª–∏–∑ + —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–æ–π
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–±–∑–∞—Ü: —á—ë—Ç–∫–∏–π —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä, –±—Ä–∏—Ñ, —Å–æ–∑–≤–æ–Ω)
- –¢–æ–Ω: —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π, —É–≤–µ—Ä–µ–Ω–Ω—ã–π, –Ω–æ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π
- –î–ª–∏–Ω–∞: 800-1200 —Å–∏–º–≤–æ–ª–æ–≤
- –§–æ—Ä–º–∞—Ç: Markdown (–∂–∏—Ä–Ω—ã–π –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤)
- –û–±—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ ¬´–≤—ã¬ª

–ó–ê–ü–†–ï–©–ï–ù–û:
- –û–±—â–∏–µ —Ñ—Ä–∞–∑—ã –±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ ('–æ—Ç–ª–∏—á–Ω–æ–µ —Ñ–æ—Ç–æ', '–∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç')
- –ö—Ä–∏—Ç–∏–∫–∞ –±–µ–∑ —Ä–µ—à–µ–Ω–∏—è
- –û–±–µ—â–∞–Ω–∏—è –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –ø–∞–∫–µ—Ç–∞–º/—Ü–µ–Ω–∞–º
- –ü—Ä–∏–¥—É–º–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–¶–ï–ù–´ (–∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ —ç—Ç–∏):
- –°—Ç–∞—Ä—Ç–µ—Ä: –æ—Ç 150 000‚ÇΩ (7-10 –¥–Ω–µ–π)
- –ë–∏–∑–Ω–µ—Å: –æ—Ç 250 000‚ÇΩ (14-21 –¥–µ–Ω—å)
- –ü—Ä–µ–º–∏—É–º: –æ—Ç 400 000‚ÇΩ (21-30 –¥–Ω–µ–π)
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏: –æ—Ç 12 000‚ÇΩ –¥–æ 120 000‚ÇΩ

–ö–õ–ò–ï–ù–¢–°–ö–ò–ô –ö–û–ù–¢–ï–ö–°–¢:
{client_context}"""


IMAGE_TYPE_INTENT_MAP: Dict[str, List[str]] = {
    ImageType.APP_SCREENSHOT.value: ["portfolio_request", "price_inquiry"],
    ImageType.WEBSITE_SCREENSHOT.value: ["price_inquiry"],
    ImageType.COMPETITOR_APP.value: ["competitor", "portfolio_request"],
    ImageType.DESIGN_MOCKUP.value: ["ready_to_buy"],
    ImageType.BUSINESS_PHOTO.value: ["price_inquiry"],
    ImageType.PRODUCT_PHOTO.value: ["price_inquiry"],
    ImageType.MENU_CATALOG.value: ["price_inquiry"],
    ImageType.ANALYTICS_SCREENSHOT.value: ["price_inquiry", "booking"],
    ImageType.DOCUMENT_TZ.value: ["ready_to_buy", "booking"],
    ImageType.GENERAL.value: [],
}

IMAGE_TYPE_SCORE_BOOST: Dict[str, int] = {
    ImageType.APP_SCREENSHOT.value: 15,
    ImageType.WEBSITE_SCREENSHOT.value: 12,
    ImageType.COMPETITOR_APP.value: 10,
    ImageType.DESIGN_MOCKUP.value: 25,
    ImageType.BUSINESS_PHOTO.value: 8,
    ImageType.PRODUCT_PHOTO.value: 10,
    ImageType.MENU_CATALOG.value: 10,
    ImageType.ANALYTICS_SCREENSHOT.value: 12,
    ImageType.DOCUMENT_TZ.value: 30,
    ImageType.GENERAL.value: 3,
}

HOT_IMAGE_TYPES = {
    ImageType.DESIGN_MOCKUP.value,
    ImageType.DOCUMENT_TZ.value,
}

WARM_IMAGE_TYPES = {
    ImageType.APP_SCREENSHOT.value,
    ImageType.WEBSITE_SCREENSHOT.value,
    ImageType.COMPETITOR_APP.value,
    ImageType.ANALYTICS_SCREENSHOT.value,
}


IMAGE_SMART_BUTTONS: Dict[str, List[tuple]] = {
    ImageType.APP_SCREENSHOT.value: [
        ("üîç –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—É–¥–∏—Ç", "start_brief"),
        ("üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å", "menu_calculator"),
        ("üìä –ù–∞—à–∏ –∫–µ–π—Å—ã", "menu_portfolio"),
    ],
    ImageType.WEBSITE_SCREENSHOT.value: [
        ("üöÄ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ Telegram", "start_brief"),
        ("üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "menu_calculator"),
        ("üì¶ –°—Ä–∞–≤–Ω–∏—Ç—å –ø–∞–∫–µ—Ç—ã", "compare_packages"),
    ],
    ImageType.COMPETITOR_APP.value: [
        ("üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º–∏", "compare_packages"),
        ("üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å", "menu_calculator"),
        ("‚≠ê –ù–∞—à–∏ –∫–µ–π—Å—ã", "menu_portfolio"),
    ],
    ImageType.DESIGN_MOCKUP.value: [
        ("üìã –°–æ—Å—Ç–∞–≤–∏—Ç—å –±—Ä–∏—Ñ", "start_brief"),
        ("üí≥ –£—Å–ª–æ–≤–∏—è –æ–ø–ª–∞—Ç—ã", "smart_payment"),
        ("üìÖ –°–æ–∑–≤–æ–Ω —Å –∫–æ–º–∞–Ω–¥–æ–π", "book_consult"),
    ],
    ImageType.BUSINESS_PHOTO.value: [
        ("üéØ –ü–æ–¥–æ–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ", "start_quiz"),
        ("üßÆ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å", "menu_calculator"),
        ("üìä –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤–∞—à–µ–π –Ω–∏—à–∏", "menu_portfolio"),
    ],
    ImageType.PRODUCT_PHOTO.value: [
        ("üõí –ú–∞–≥–∞–∑–∏–Ω –≤ Telegram", "menu_calculator"),
        ("üìã –ë—Ä–∏—Ñ –Ω–∞ –º–∞–≥–∞–∑–∏–Ω", "start_brief"),
        ("üì¶ –ü–∞–∫–µ—Ç—ã", "compare_packages"),
    ],
    ImageType.MENU_CATALOG.value: [
        ("üì± –¶–∏—Ñ—Ä–æ–≤–æ–µ –º–µ–Ω—é", "menu_calculator"),
        ("üìã –°–æ—Å—Ç–∞–≤–∏—Ç—å –±—Ä–∏—Ñ", "start_brief"),
        ("‚≠ê –ö–µ–π—Å—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤", "menu_portfolio"),
    ],
    ImageType.ANALYTICS_SCREENSHOT.value: [
        ("üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ Mini App", "menu_calculator"),
        ("üìÖ –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", "book_consult"),
        ("üì¶ –ü–∞–∫–µ—Ç —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π", "compare_packages"),
    ],
    ImageType.DOCUMENT_TZ.value: [
        ("üìÖ –°–æ–∑–≤–æ–Ω –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è", "book_consult"),
        ("üí≥ –£—Å–ª–æ–≤–∏—è –∏ –æ–ø–ª–∞—Ç–∞", "smart_payment"),
        ("üìÑ –î–æ–≥–æ–≤–æ—Ä", "smart_contract"),
    ],
    ImageType.GENERAL.value: [
        ("üéØ –ü–æ–¥–æ–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ", "start_quiz"),
        ("üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "menu_calculator"),
        ("üìä –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ", "menu_portfolio"),
    ],
}


def get_image_type_from_caption(caption: str) -> Optional[str]:
    if not caption:
        return None
    lower = caption.lower()

    if any(w in lower for w in ["–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç", "—á—É–∂–æ–π", "—É –Ω–∏—Ö", "–∫–∞–∫ —É", "–≤–∏–¥–µ–ª —É", "–Ω–∞—à—ë–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"]):
        return ImageType.COMPETITOR_APP.value
    if any(w in lower for w in ["–º–æ–π —Å–∞–π—Ç", "–Ω–∞—à —Å–∞–π—Ç", "–≤–æ—Ç —Å–∞–π—Ç", "—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–∞–π—Ç–∞"]):
        return ImageType.WEBSITE_SCREENSHOT.value
    if any(w in lower for w in ["–º–∞–∫–µ—Ç", "–¥–∏–∑–∞–π–Ω", "–ø—Ä–æ—Ç–æ—Ç–∏–ø", "figma", "—Ñ–∏–≥–º–∞", "wireframe", "–º–æ–∫–∞–ø"]):
        return ImageType.DESIGN_MOCKUP.value
    if any(w in lower for w in ["—Ç–∑", "—Ç–µ—Ö–∑–∞–¥–∞–Ω–∏–µ", "—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ", "–±—Ä–∏—Ñ", "—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è", "—Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π"]):
        return ImageType.DOCUMENT_TZ.value
    if any(w in lower for w in ["–º–µ–Ω—é", "–ø—Ä–∞–π—Å", "–∫–∞—Ç–∞–ª–æ–≥", "–±—É–∫–ª–µ—Ç", "–ª–∏—Å—Ç–æ–≤–∫–∞"]):
        return ImageType.MENU_CATALOG.value
    if any(w in lower for w in ["—Ç–æ–≤–∞—Ä", "–ø—Ä–æ–¥—É–∫—Ç", "–ø—Ä–æ–¥—É–∫—Ü–∏—è", "–∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç"]):
        return ImageType.PRODUCT_PHOTO.value
    if any(w in lower for w in ["–º–∞–≥–∞–∑–∏–Ω", "—Ä–µ—Å—Ç–æ—Ä–∞–Ω", "—Å–∞–ª–æ–Ω", "–æ—Ñ–∏—Å", "–ø–æ–º–µ—â–µ–Ω–∏–µ", "–∏–Ω—Ç–µ—Ä—å–µ—Ä"]):
        return ImageType.BUSINESS_PHOTO.value
    if any(w in lower for w in ["–∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "–º–µ—Ç—Ä–∏–∫–∏", "–¥–∞—à–±–æ—Ä–¥", "–≥—Ä–∞—Ñ–∏–∫–∏", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"]):
        return ImageType.ANALYTICS_SCREENSHOT.value
    if any(w in lower for w in ["–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", "–∞–ø–ø", "app", "–º–∏–Ω–∏-–∞–ø–ø", "—Å–∫—Ä–∏–Ω—à–æ—Ç"]):
        return ImageType.APP_SCREENSHOT.value
    return None


def build_vision_system_prompt(image_type: str, client_context: Optional[str] = None) -> str:
    type_prompt = IMAGE_TYPE_PROMPTS.get(image_type, IMAGE_TYPE_PROMPTS[ImageType.GENERAL.value])
    ctx = client_context or "–ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ –∫–ª–∏–µ–Ω—Ç–µ."
    return VISION_SALES_SYSTEM.format(
        image_type_prompt=type_prompt,
        client_context=ctx,
    )


def get_smart_buttons_for_image(image_type: str) -> List[tuple]:
    return IMAGE_SMART_BUTTONS.get(image_type, IMAGE_SMART_BUTTONS[ImageType.GENERAL.value])


def get_lead_score_boost(image_type: str) -> int:
    return IMAGE_TYPE_SCORE_BOOST.get(image_type, 3)


def get_intents_for_image(image_type: str) -> List[str]:
    return IMAGE_TYPE_INTENT_MAP.get(image_type, [])


def is_hot_image(image_type: str) -> bool:
    return image_type in HOT_IMAGE_TYPES


def is_warm_image(image_type: str) -> bool:
    return image_type in WARM_IMAGE_TYPES


def build_manager_notification(
    user_id: int,
    username: Optional[str],
    first_name: Optional[str],
    image_type: str,
    caption: Optional[str] = None,
) -> Optional[str]:
    if not is_hot_image(image_type) and not is_warm_image(image_type):
        return None

    type_labels = {
        ImageType.APP_SCREENSHOT.value: "—Å–∫—Ä–∏–Ω—à–æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
        ImageType.WEBSITE_SCREENSHOT.value: "—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–∞–π—Ç–∞",
        ImageType.COMPETITOR_APP.value: "—Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞",
        ImageType.DESIGN_MOCKUP.value: "–¥–∏–∑–∞–π–Ω-–º–∞–∫–µ—Ç / –ø—Ä–æ—Ç–æ—Ç–∏–ø",
        ImageType.DOCUMENT_TZ.value: "–¢–ó / –¥–æ–∫—É–º–µ–Ω—Ç",
        ImageType.ANALYTICS_SCREENSHOT.value: "—Å–∫—Ä–∏–Ω—à–æ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∏",
    }

    priority = "üî• –ì–û–†–Ø–ß–ò–ô" if is_hot_image(image_type) else "üü° –¢–Å–ü–õ–´–ô"
    type_label = type_labels.get(image_type, image_type)
    name = first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    uname = f"@{username}" if username else "no_username"

    text = (
        f"üì∏ <b>–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª {type_label}!</b>\n\n"
        f"{priority} —Å–∏–≥–Ω–∞–ª\n"
        f"üë§ {name} ({uname})\n"
        f"üÜî ID: {user_id}\n"
    )
    if caption:
        text += f"üí¨ –ü–æ–¥–ø–∏—Å—å: {caption[:200]}\n"

    if is_hot_image(image_type):
        text += "\n‚ö° <b>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</b> –°–≤—è–∑–∞—Ç—å—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞"

    return text


def get_vision_analysis_context(image_type: str) -> str:
    contexts = {
        ImageType.APP_SCREENSHOT.value: "[VISION: –°–ö–†–ò–ù–®–û–¢ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø]\n–ö–ª–∏–µ–Ω—Ç –ø–æ–∫–∞–∑–∞–ª —Å–≤–æ–π/—á—É–∂–æ–π –∞–ø–ø. –î–∞–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π UX-–∞—É–¥–∏—Ç —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –∏ —Ü–µ–Ω–∞–º–∏ WEB4TG.",
        ImageType.WEBSITE_SCREENSHOT.value: "[VISION: –°–ö–†–ò–ù–®–û–¢ –°–ê–ô–¢–ê]\n–ö–ª–∏–µ–Ω—Ç –ø–æ–∫–∞–∑–∞–ª —Å–≤–æ–π —Å–∞–π—Ç. –û—Ü–µ–Ω–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –º–∏–≥—Ä–∞—Ü–∏—é –≤ Telegram Mini App —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –≤—ã–≥–æ–¥–∞–º–∏.",
        ImageType.COMPETITOR_APP.value: "[VISION: –ö–û–ù–ö–£–†–ï–ù–¢]\n–ö–ª–∏–µ–Ω—Ç –∏—Å—Å–ª–µ–¥—É–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤. –û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ + –∫–∞–∫ WEB4TG —Å–¥–µ–ª–∞–µ—Ç –ª—É—á—à–µ.",
        ImageType.DESIGN_MOCKUP.value: "[VISION: –î–ò–ó–ê–ô–ù-–ú–ê–ö–ï–¢ ‚Äî –ì–û–†–Ø–ß–ò–ô –õ–ò–î]\n–ö–ª–∏–µ–Ω—Ç —É–∂–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä—É–µ—Ç! –û—Ü–µ–Ω–∏ –º–∞–∫–µ—Ç, –ø–æ—Ö–≤–∞–ª–∏ —Ö–æ—Ä–æ—à–µ–µ, –ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é.",
        ImageType.BUSINESS_PHOTO.value: "[VISION: –§–û–¢–û –ë–ò–ó–ù–ï–°–ê]\n–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø –±–∏–∑–Ω–µ—Å–∞ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ Mini App.",
        ImageType.PRODUCT_PHOTO.value: "[VISION: –§–û–¢–û –¢–û–í–ê–†–ê]\n–ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –ø—Ä–æ–¥–∞–≤–∞—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä. –ü—Ä–µ–¥–ª–æ–∂–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –≤ Telegram.",
        ImageType.MENU_CATALOG.value: "[VISION: –ú–ï–ù–Æ/–ö–ê–¢–ê–õ–û–ì]\n–ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –æ—Ü–∏—Ñ—Ä–æ–≤–∞—Ç—å –º–µ–Ω—é/–∫–∞—Ç–∞–ª–æ–≥. –ü—Ä–µ–¥–ª–æ–∂–∏ —Ü–∏—Ñ—Ä–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ Mini App.",
        ImageType.ANALYTICS_SCREENSHOT.value: "[VISION: –ê–ù–ê–õ–ò–¢–ò–ö–ê]\n–ö–ª–∏–µ–Ω—Ç –¥—É–º–∞–µ—Ç –æ —Ä–æ—Å—Ç–µ. –ü—Ä–µ–¥–ª–æ–∂–∏ Mini App —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π.",
        ImageType.DOCUMENT_TZ.value: "[VISION: –¢–ó/–î–û–ö–£–ú–ï–ù–¢ ‚Äî –ì–û–†–Ø–ß–ò–ô –õ–ò–î]\n–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª –≥–æ—Ç–æ–≤–æ–µ –¢–ó! –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ: –æ—Ü–µ–Ω–∏, –ø—Ä–µ–¥–ª–æ–∂–∏ —Å–æ–∑–≤–æ–Ω.",
        ImageType.GENERAL.value: "[VISION: –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï]\n–ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–ª–∞–ª —Ñ–æ—Ç–æ. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∏ —Å–≤—è–∂–∏ —Å —É—Å–ª—É–≥–∞–º–∏ WEB4TG Studio.",
    }
    return contexts.get(image_type, contexts[ImageType.GENERAL.value])
